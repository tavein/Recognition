

问题三
======

Addtional Requirements
------------

opencv解压的根目录下，sources/data路径，有几个装着级联分类器的文件夹。

我们需要里面的xml文件，这是预训练的分类器。


问题的分析
----------



- 第三个问题其实有两个子问题

.. code:: PlainText

  1.识别出人，并能分辨不同的人。
  2.对不同的人进行追踪。

- 是否应该沿袭之前两道题的做法，即进行标准的机器学习流程。
.. code:: PlainText

  我认为答案是否定的。
  从如下方面叙述：
    1.数据标记的困难。
      一个区域如果包含多个人，那么应该如何对数据打标签。
      而如果找不到标标签的好方法，连监督模型都没法训练。
      （其实可以先识别人，再对判断结果进行再识别，以分离不同的识别对象；
        这个方法听起来可行，但是经过我尝试后，发现识别出人这个过程，
        需要的数据量是一张图片不足以提供的。
        这促使我去寻找预训练模型。
    2.识别不同人的方法。
      如果直接通过模型给出的预测标签来分类，那么
        训练数据至少应该包含这个人的信息，也就是所有需要跟踪的人的信息应该预先录入。
        而每一个要追踪的人只在连续的很少几张图里出现...
        再泛化一下问题，如果要建立对一个公共场所的行人路径追踪模型...
      所以直接通过模型来给出是否为识别对象的判断，对于非特定追踪问题是不行的。
        不过追踪罪犯这类问题自然可以这么做。
    3.追踪的方法
      根据1，2的讨论，机器学习模型无法直接给出像
        “前一张图的某个人在第二张图里最可能是哪一个”
      的这种判断，于是问题1和问题2的解决思路是无法沿袭的。

- 解决方案

.. code:: PlainText

  1.集成使用预训练的级联分类器，
      (1) 上半身识别器
      (2) 下半身识别器
      (3) 面部识别器
      (4) 全身识别器。
    使用以上预训练分类器可以从图片里边直接抓出可能为人的section。
    然后我们对这些section求极小值，这个话什么意思呢...我下面解释一下。

        首先定义偏序关系，
          如果一个section A被完全包含在 一个section B中，则记 A<=B
          那么显然，我们可以画Hasse图来求得所有的极小值。（不理解hasse图求极值的同学，我以后再补个图...）

    我们取所有的极小值，每一个极小值都是一块section，我们把这些极小值视作识别为人的部分。
    这么做的原因，要说起来还是比较麻烦的...
    主要有如下两个：
      (1) 当两个section具有如上偏序关系时，较大的section必然包含了更多对于识别无用的信息。
      (2) 每种预训练的分类器的recall低，但precision是比较高的，并联多种级联分类器提升查全率，
          取极小值可以保持precision，这是zhui hou的。
  2.比较连续的两张图，进行行人的匹配。
    (这是高潮！！！这个地方是这道数模题唯一的亮点，然后我成功的利用了一点概率论和代数喵喵喵~

    首先要讲一下SIFT特征。
    这个任务，请交给我们csdn的朋友来讲述，请看相关链接。

    你要是看完了叙述，你应该知道了SIFT特征点是什么。
    其性质非常好：
      (1) 尺度不变
      (2) 旋转不变
    好了，现在opencv给了接口，能够让你调接口获取两张图片的所有匹配特征点。
    然后，大家打算如何用？
    首先，我们要识别的是动态物体，行人。
    那么，我们注意到，静态物体由于本身没有变化，SIFT特征点对匹配的程度，相比行人身上的匹配，
    应该是非常高的。所以我们这里要做一个filter，网上查资料都说取匹配度小于0.8的，我这边调参调出来
    是0.5-0.85，也就是说，还有个下界(至于为什么会有下界，应该是个有意思的问题，甩给泥萌啦...)。

    做了这个filter之后，我们可以认为这些匹配的特征点对里属于行人的成分已经比较高了。
    然后我们研究前后两张图里识别出同一个行人和特征点匹配的关系。
    然后就该本数模题唯一上台面的东西出场了。

    剩下的理论部分，我是用latex写的，因为公式一堆。
    请在相关链接部分查看(不然接下来你什么都看不懂)。

    当你看完pdf后，你应该知道那个可爱的矩阵了。

    我们求出矩阵第i行的最大值和最大值所在的序号j,如果M[i,j]大于一个阈值，则

    我们认为前一张图片里的第i个人，就是后一张图片里的第j个。

    由此，圆满谢幕~

结果数据集
-----

`所有问题的结果 <http://pan.baidu.com/s/1pKOYsAZ>`

.. code:: PlainText

  点击打开question3文件夹

- 相关链接

`SIFT特征提取分析by Rachel-Zhang <http://blog.csdn.net/abcjennifer/article/details/7639681>`_
`SIFT特征匹配位置特异性得分矩阵by merself <https://github.com/thautwarm/Recognition/blob/master/PedestrianRecognition/Question3/siftmsc.pdf>`
